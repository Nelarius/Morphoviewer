var Delaunay;!function(){"use strict";function t(t){var r,e,n,a,i,o,u=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(r=t.length;r--;)t[r][0]<u&&(u=t[r][0]),t[r][0]>c&&(c=t[r][0]),t[r][1]<s&&(s=t[r][1]),t[r][1]>l&&(l=t[r][1]);return e=c-u,n=l-s,a=Math.max(e,n),i=u+.5*e,o=s+.5*n,[[i-20*a,o-a],[i,o+20*a],[i+20*a,o-a]]}function r(t,r,e,a){var i,o,u,s,c,l,f,m,h,v,p=t[r][0],d=t[r][1],g=t[e][0],M=t[e][1],b=t[a][0],y=t[a][1],w=Math.abs(d-M),A=Math.abs(M-y);if(n>w&&n>A)throw new Error("Eek! Coincident points!");return n>w?(s=-((b-g)/(y-M)),l=(g+b)/2,m=(M+y)/2,i=(g+p)/2,o=s*(i-l)+m):n>A?(u=-((g-p)/(M-d)),c=(p+g)/2,f=(d+M)/2,i=(b+g)/2,o=u*(i-c)+f):(u=-((g-p)/(M-d)),s=-((b-g)/(y-M)),c=(p+g)/2,l=(g+b)/2,f=(d+M)/2,m=(M+y)/2,i=(u*c-s*l+m-f)/(u-s),o=w>A?u*(i-c)+f:s*(i-l)+m),h=g-i,v=M-o,{i:r,j:e,k:a,x:i,y:o,r:h*h+v*v}}function e(t){var r,e,n,a,i,o;for(e=t.length;e;)for(a=t[--e],n=t[--e],r=e;r;)if(o=t[--r],i=t[--r],n===i&&a===o||n===o&&a===i){t.splice(e,2),t.splice(r,2);break}}var n=1/1048576;Delaunay={triangulate:function(a,i){var o,u,s,c,l,f,m,h,v,p,d,g,M=a.length;if(3>M)return[];if(a=a.slice(0),i)for(o=M;o--;)a[o]=a[o][i];for(s=new Array(M),o=M;o--;)s[o]=o;for(s.sort(function(t,r){return a[r][0]-a[t][0]}),c=t(a),a.push(c[0],c[1],c[2]),l=[r(a,M+0,M+1,M+2)],f=[],m=[],o=s.length;o--;m.length=0){for(g=s[o],u=l.length;u--;)h=a[g][0]-l[u].x,h>0&&h*h>l[u].r?(f.push(l[u]),l.splice(u,1)):(v=a[g][1]-l[u].y,h*h+v*v-l[u].r>n||(m.push(l[u].i,l[u].j,l[u].j,l[u].k,l[u].k,l[u].i),l.splice(u,1)));for(e(m),u=m.length;u;)d=m[--u],p=m[--u],l.push(r(a,p,d,g))}for(o=l.length;o--;)f.push(l[o]);for(l.length=0,o=f.length;o--;)f[o].i<M&&f[o].j<M&&f[o].k<M&&l.push(f[o].i,f[o].j,f[o].k);return l},contains:function(t,r){if(r[0]<t[0][0]&&r[0]<t[1][0]&&r[0]<t[2][0]||r[0]>t[0][0]&&r[0]>t[1][0]&&r[0]>t[2][0]||r[1]<t[0][1]&&r[1]<t[1][1]&&r[1]<t[2][1]||r[1]>t[0][1]&&r[1]>t[1][1]&&r[1]>t[2][1])return null;var e=t[1][0]-t[0][0],n=t[2][0]-t[0][0],a=t[1][1]-t[0][1],i=t[2][1]-t[0][1],o=e*i-n*a;if(0===o)return null;var u=(i*(r[0]-t[0][0])-n*(r[1]-t[0][1]))/o,s=(e*(r[1]-t[0][1])-a*(r[0]-t[0][0]))/o;return 0>u||0>s||u+s>1?null:[u,s]}},"undefined"!=typeof module&&(module.exports=Delaunay)}(),function(t){"use strict";var r={};"undefined"==typeof exports?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(r.exports={},define(function(){return r.exports})):r.exports="undefined"!=typeof window?window:t:r.exports=exports,function(t){if(!r)var r=1e-6;if(!e)var e="undefined"!=typeof Float32Array?Float32Array:Array;if(!n)var n=Math.random;var a={};a.setMatrixArrayType=function(t){e=t},"undefined"!=typeof t&&(t.glMatrix=a);var i=Math.PI/180;a.toRadian=function(t){return t*i};var o={};o.create=function(){var t=new e(2);return t[0]=0,t[1]=0,t},o.clone=function(t){var r=new e(2);return r[0]=t[0],r[1]=t[1],r},o.fromValues=function(t,r){var n=new e(2);return n[0]=t,n[1]=r,n},o.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t},o.set=function(t,r,e){return t[0]=r,t[1]=e,t},o.add=function(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t},o.subtract=function(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t},o.sub=o.subtract,o.multiply=function(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t},o.mul=o.multiply,o.divide=function(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t},o.div=o.divide,o.min=function(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t},o.max=function(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t},o.scale=function(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t},o.scaleAndAdd=function(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t},o.distance=function(t,r){var e=r[0]-t[0],n=r[1]-t[1];return Math.sqrt(e*e+n*n)},o.dist=o.distance,o.squaredDistance=function(t,r){var e=r[0]-t[0],n=r[1]-t[1];return e*e+n*n},o.sqrDist=o.squaredDistance,o.length=function(t){var r=t[0],e=t[1];return Math.sqrt(r*r+e*e)},o.len=o.length,o.squaredLength=function(t){var r=t[0],e=t[1];return r*r+e*e},o.sqrLen=o.squaredLength,o.negate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t},o.normalize=function(t,r){var e=r[0],n=r[1],a=e*e+n*n;return a>0&&(a=1/Math.sqrt(a),t[0]=r[0]*a,t[1]=r[1]*a),t},o.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]},o.cross=function(t,r,e){var n=r[0]*e[1]-r[1]*e[0];return t[0]=t[1]=0,t[2]=n,t},o.lerp=function(t,r,e,n){var a=r[0],i=r[1];return t[0]=a+n*(e[0]-a),t[1]=i+n*(e[1]-i),t},o.random=function(t,r){r=r||1;var e=2*n()*Math.PI;return t[0]=Math.cos(e)*r,t[1]=Math.sin(e)*r,t},o.transformMat2=function(t,r,e){var n=r[0],a=r[1];return t[0]=e[0]*n+e[2]*a,t[1]=e[1]*n+e[3]*a,t},o.transformMat2d=function(t,r,e){var n=r[0],a=r[1];return t[0]=e[0]*n+e[2]*a+e[4],t[1]=e[1]*n+e[3]*a+e[5],t},o.transformMat3=function(t,r,e){var n=r[0],a=r[1];return t[0]=e[0]*n+e[3]*a+e[6],t[1]=e[1]*n+e[4]*a+e[7],t},o.transformMat4=function(t,r,e){var n=r[0],a=r[1];return t[0]=e[0]*n+e[4]*a+e[12],t[1]=e[1]*n+e[5]*a+e[13],t},o.forEach=function(){var t=o.create();return function(r,e,n,a,i,o){var u,s;for(e||(e=2),n||(n=0),s=a?Math.min(a*e+n,r.length):r.length,u=n;s>u;u+=e)t[0]=r[u],t[1]=r[u+1],i(t,t,o),r[u]=t[0],r[u+1]=t[1];return r}}(),o.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},"undefined"!=typeof t&&(t.vec2=o);var u={};u.create=function(){var t=new e(3);return t[0]=0,t[1]=0,t[2]=0,t},u.clone=function(t){var r=new e(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r},u.fromValues=function(t,r,n){var a=new e(3);return a[0]=t,a[1]=r,a[2]=n,a},u.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},u.set=function(t,r,e,n){return t[0]=r,t[1]=e,t[2]=n,t},u.add=function(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t},u.subtract=function(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t},u.sub=u.subtract,u.multiply=function(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t},u.mul=u.multiply,u.divide=function(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t},u.div=u.divide,u.min=function(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t},u.max=function(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t},u.scale=function(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t},u.scaleAndAdd=function(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t},u.distance=function(t,r){var e=r[0]-t[0],n=r[1]-t[1],a=r[2]-t[2];return Math.sqrt(e*e+n*n+a*a)},u.dist=u.distance,u.squaredDistance=function(t,r){var e=r[0]-t[0],n=r[1]-t[1],a=r[2]-t[2];return e*e+n*n+a*a},u.sqrDist=u.squaredDistance,u.length=function(t){var r=t[0],e=t[1],n=t[2];return Math.sqrt(r*r+e*e+n*n)},u.len=u.length,u.squaredLength=function(t){var r=t[0],e=t[1],n=t[2];return r*r+e*e+n*n},u.sqrLen=u.squaredLength,u.negate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t},u.normalize=function(t,r){var e=r[0],n=r[1],a=r[2],i=e*e+n*n+a*a;return i>0&&(i=1/Math.sqrt(i),t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i),t},u.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},u.cross=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=e[0],u=e[1],s=e[2];return t[0]=a*s-i*u,t[1]=i*o-n*s,t[2]=n*u-a*o,t},u.lerp=function(t,r,e,n){var a=r[0],i=r[1],o=r[2];return t[0]=a+n*(e[0]-a),t[1]=i+n*(e[1]-i),t[2]=o+n*(e[2]-o),t},u.random=function(t,r){r=r||1;var e=2*n()*Math.PI,a=2*n()-1,i=Math.sqrt(1-a*a)*r;return t[0]=Math.cos(e)*i,t[1]=Math.sin(e)*i,t[2]=a*r,t},u.transformMat4=function(t,r,e){var n=r[0],a=r[1],i=r[2];return t[0]=e[0]*n+e[4]*a+e[8]*i+e[12],t[1]=e[1]*n+e[5]*a+e[9]*i+e[13],t[2]=e[2]*n+e[6]*a+e[10]*i+e[14],t},u.transformMat3=function(t,r,e){var n=r[0],a=r[1],i=r[2];return t[0]=n*e[0]+a*e[3]+i*e[6],t[1]=n*e[1]+a*e[4]+i*e[7],t[2]=n*e[2]+a*e[5]+i*e[8],t},u.transformQuat=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=e[0],u=e[1],s=e[2],c=e[3],l=c*n+u*i-s*a,f=c*a+s*n-o*i,m=c*i+o*a-u*n,h=-o*n-u*a-s*i;return t[0]=l*c+h*-o+f*-s-m*-u,t[1]=f*c+h*-u+m*-o-l*-s,t[2]=m*c+h*-s+l*-u-f*-o,t},u.rotateX=function(t,r,e,n){var a=[],i=[];return a[0]=r[0]-e[0],a[1]=r[1]-e[1],a[2]=r[2]-e[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),t[0]=i[0]+e[0],t[1]=i[1]+e[1],t[2]=i[2]+e[2],t},u.rotateY=function(t,r,e,n){var a=[],i=[];return a[0]=r[0]-e[0],a[1]=r[1]-e[1],a[2]=r[2]-e[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),t[0]=i[0]+e[0],t[1]=i[1]+e[1],t[2]=i[2]+e[2],t},u.rotateZ=function(t,r,e,n){var a=[],i=[];return a[0]=r[0]-e[0],a[1]=r[1]-e[1],a[2]=r[2]-e[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],t[0]=i[0]+e[0],t[1]=i[1]+e[1],t[2]=i[2]+e[2],t},u.forEach=function(){var t=u.create();return function(r,e,n,a,i,o){var u,s;for(e||(e=3),n||(n=0),s=a?Math.min(a*e+n,r.length):r.length,u=n;s>u;u+=e)t[0]=r[u],t[1]=r[u+1],t[2]=r[u+2],i(t,t,o),r[u]=t[0],r[u+1]=t[1],r[u+2]=t[2];return r}}(),u.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},"undefined"!=typeof t&&(t.vec3=u);var s={};s.create=function(){var t=new e(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},s.clone=function(t){var r=new e(4);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},s.fromValues=function(t,r,n,a){var i=new e(4);return i[0]=t,i[1]=r,i[2]=n,i[3]=a,i},s.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},s.set=function(t,r,e,n,a){return t[0]=r,t[1]=e,t[2]=n,t[3]=a,t},s.add=function(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t},s.subtract=function(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t},s.sub=s.subtract,s.multiply=function(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t[3]=r[3]*e[3],t},s.mul=s.multiply,s.divide=function(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t[3]=r[3]/e[3],t},s.div=s.divide,s.min=function(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t[3]=Math.min(r[3],e[3]),t},s.max=function(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t[3]=Math.max(r[3],e[3]),t},s.scale=function(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t},s.scaleAndAdd=function(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t},s.distance=function(t,r){var e=r[0]-t[0],n=r[1]-t[1],a=r[2]-t[2],i=r[3]-t[3];return Math.sqrt(e*e+n*n+a*a+i*i)},s.dist=s.distance,s.squaredDistance=function(t,r){var e=r[0]-t[0],n=r[1]-t[1],a=r[2]-t[2],i=r[3]-t[3];return e*e+n*n+a*a+i*i},s.sqrDist=s.squaredDistance,s.length=function(t){var r=t[0],e=t[1],n=t[2],a=t[3];return Math.sqrt(r*r+e*e+n*n+a*a)},s.len=s.length,s.squaredLength=function(t){var r=t[0],e=t[1],n=t[2],a=t[3];return r*r+e*e+n*n+a*a},s.sqrLen=s.squaredLength,s.negate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t},s.normalize=function(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=e*e+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=r[0]*o,t[1]=r[1]*o,t[2]=r[2]*o,t[3]=r[3]*o),t},s.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3]},s.lerp=function(t,r,e,n){var a=r[0],i=r[1],o=r[2],u=r[3];return t[0]=a+n*(e[0]-a),t[1]=i+n*(e[1]-i),t[2]=o+n*(e[2]-o),t[3]=u+n*(e[3]-u),t},s.random=function(t,r){return r=r||1,t[0]=n(),t[1]=n(),t[2]=n(),t[3]=n(),s.normalize(t,t),s.scale(t,t,r),t},s.transformMat4=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3];return t[0]=e[0]*n+e[4]*a+e[8]*i+e[12]*o,t[1]=e[1]*n+e[5]*a+e[9]*i+e[13]*o,t[2]=e[2]*n+e[6]*a+e[10]*i+e[14]*o,t[3]=e[3]*n+e[7]*a+e[11]*i+e[15]*o,t},s.transformQuat=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=e[0],u=e[1],s=e[2],c=e[3],l=c*n+u*i-s*a,f=c*a+s*n-o*i,m=c*i+o*a-u*n,h=-o*n-u*a-s*i;return t[0]=l*c+h*-o+f*-s-m*-u,t[1]=f*c+h*-u+m*-o-l*-s,t[2]=m*c+h*-s+l*-u-f*-o,t},s.forEach=function(){var t=s.create();return function(r,e,n,a,i,o){var u,s;for(e||(e=4),n||(n=0),s=a?Math.min(a*e+n,r.length):r.length,u=n;s>u;u+=e)t[0]=r[u],t[1]=r[u+1],t[2]=r[u+2],t[3]=r[u+3],i(t,t,o),r[u]=t[0],r[u+1]=t[1],r[u+2]=t[2],r[u+3]=t[3];return r}}(),s.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.vec4=s);var c={};c.create=function(){var t=new e(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},c.clone=function(t){var r=new e(4);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},c.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},c.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},c.transpose=function(t,r){if(t===r){var e=r[1];t[1]=r[2],t[2]=e}else t[0]=r[0],t[1]=r[2],t[2]=r[1],t[3]=r[3];return t},c.invert=function(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=e*i-a*n;return o?(o=1/o,t[0]=i*o,t[1]=-n*o,t[2]=-a*o,t[3]=e*o,t):null},c.adjoint=function(t,r){var e=r[0];return t[0]=r[3],t[1]=-r[1],t[2]=-r[2],t[3]=e,t},c.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},c.multiply=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=e[0],s=e[1],c=e[2],l=e[3];return t[0]=n*u+i*s,t[1]=a*u+o*s,t[2]=n*c+i*l,t[3]=a*c+o*l,t},c.mul=c.multiply,c.rotate=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=Math.sin(e),s=Math.cos(e);return t[0]=n*s+i*u,t[1]=a*s+o*u,t[2]=n*-u+i*s,t[3]=a*-u+o*s,t},c.scale=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=e[0],s=e[1];return t[0]=n*u,t[1]=a*u,t[2]=i*s,t[3]=o*s,t},c.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},c.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},c.LDU=function(t,r,e,n){return t[2]=n[2]/n[0],e[0]=n[0],e[1]=n[1],e[3]=n[3]-t[2]*e[1],[t,r,e]},"undefined"!=typeof t&&(t.mat2=c);var l={};l.create=function(){var t=new e(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},l.clone=function(t){var r=new e(6);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r},l.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t},l.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},l.invert=function(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=r[4],u=r[5],s=e*i-n*a;return s?(s=1/s,t[0]=i*s,t[1]=-n*s,t[2]=-a*s,t[3]=e*s,t[4]=(a*u-i*o)*s,t[5]=(n*o-e*u)*s,t):null},l.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},l.multiply=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=e[0],l=e[1],f=e[2],m=e[3],h=e[4],v=e[5];return t[0]=n*c+i*l,t[1]=a*c+o*l,t[2]=n*f+i*m,t[3]=a*f+o*m,t[4]=n*h+i*v+u,t[5]=a*h+o*v+s,t},l.mul=l.multiply,l.rotate=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=Math.sin(e),l=Math.cos(e);return t[0]=n*l+i*c,t[1]=a*l+o*c,t[2]=n*-c+i*l,t[3]=a*-c+o*l,t[4]=u,t[5]=s,t},l.scale=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=e[0],l=e[1];return t[0]=n*c,t[1]=a*c,t[2]=i*l,t[3]=o*l,t[4]=u,t[5]=s,t},l.translate=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=e[0],l=e[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=n*c+i*l+u,t[5]=a*c+o*l+s,t},l.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},l.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},"undefined"!=typeof t&&(t.mat2d=l);var f={};f.create=function(){var t=new e(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},f.fromMat4=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[4],t[4]=r[5],t[5]=r[6],t[6]=r[8],t[7]=r[9],t[8]=r[10],t},f.clone=function(t){var r=new e(9);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r},f.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t},f.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},f.transpose=function(t,r){if(t===r){var e=r[1],n=r[2],a=r[5];t[1]=r[3],t[2]=r[6],t[3]=e,t[5]=r[7],t[6]=n,t[7]=a}else t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8];return t},f.invert=function(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=r[4],u=r[5],s=r[6],c=r[7],l=r[8],f=l*o-u*c,m=-l*i+u*s,h=c*i-o*s,v=e*f+n*m+a*h;return v?(v=1/v,t[0]=f*v,t[1]=(-l*n+a*c)*v,t[2]=(u*n-a*o)*v,t[3]=m*v,t[4]=(l*e-a*s)*v,t[5]=(-u*e+a*i)*v,t[6]=h*v,t[7]=(-c*e+n*s)*v,t[8]=(o*e-n*i)*v,t):null},f.adjoint=function(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=r[4],u=r[5],s=r[6],c=r[7],l=r[8];return t[0]=o*l-u*c,t[1]=a*c-n*l,t[2]=n*u-a*o,t[3]=u*s-i*l,t[4]=e*l-a*s,t[5]=a*i-e*u,t[6]=i*c-o*s,t[7]=n*s-e*c,t[8]=e*o-n*i,t},f.determinant=function(t){var r=t[0],e=t[1],n=t[2],a=t[3],i=t[4],o=t[5],u=t[6],s=t[7],c=t[8];return r*(c*i-o*s)+e*(-c*a+o*u)+n*(s*a-i*u)},f.multiply=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=r[6],l=r[7],f=r[8],m=e[0],h=e[1],v=e[2],p=e[3],d=e[4],g=e[5],M=e[6],b=e[7],y=e[8];return t[0]=m*n+h*o+v*c,t[1]=m*a+h*u+v*l,t[2]=m*i+h*s+v*f,t[3]=p*n+d*o+g*c,t[4]=p*a+d*u+g*l,t[5]=p*i+d*s+g*f,t[6]=M*n+b*o+y*c,t[7]=M*a+b*u+y*l,t[8]=M*i+b*s+y*f,t},f.mul=f.multiply,f.translate=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=r[6],l=r[7],f=r[8],m=e[0],h=e[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=u,t[5]=s,t[6]=m*n+h*o+c,t[7]=m*a+h*u+l,t[8]=m*i+h*s+f,t},f.rotate=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=r[6],l=r[7],f=r[8],m=Math.sin(e),h=Math.cos(e);return t[0]=h*n+m*o,t[1]=h*a+m*u,t[2]=h*i+m*s,t[3]=h*o-m*n,t[4]=h*u-m*a,t[5]=h*s-m*i,t[6]=c,t[7]=l,t[8]=f,t},f.scale=function(t,r,e){var n=e[0],a=e[1];return t[0]=n*r[0],t[1]=n*r[1],t[2]=n*r[2],t[3]=a*r[3],t[4]=a*r[4],t[5]=a*r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t},f.fromMat2d=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=0,t[3]=r[2],t[4]=r[3],t[5]=0,t[6]=r[4],t[7]=r[5],t[8]=1,t},f.fromQuat=function(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=e+e,u=n+n,s=a+a,c=e*o,l=n*o,f=n*u,m=a*o,h=a*u,v=a*s,p=i*o,d=i*u,g=i*s;return t[0]=1-f-v,t[3]=l-g,t[6]=m+d,t[1]=l+g,t[4]=1-c-v,t[7]=h-p,t[2]=m-d,t[5]=h+p,t[8]=1-c-f,t},f.normalFromMat4=function(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=r[4],u=r[5],s=r[6],c=r[7],l=r[8],f=r[9],m=r[10],h=r[11],v=r[12],p=r[13],d=r[14],g=r[15],M=e*u-n*o,b=e*s-a*o,y=e*c-i*o,w=n*s-a*u,A=n*c-i*u,I=a*c-i*s,P=l*p-f*v,C=l*d-m*v,x=l*g-h*v,F=f*d-m*p,V=f*g-h*p,T=m*g-h*d,N=M*T-b*V+y*F+w*x-A*C+I*P;return N?(N=1/N,t[0]=(u*T-s*V+c*F)*N,t[1]=(s*x-o*T-c*C)*N,t[2]=(o*V-u*x+c*P)*N,t[3]=(a*V-n*T-i*F)*N,t[4]=(e*T-a*x+i*C)*N,t[5]=(n*x-e*V-i*P)*N,t[6]=(p*I-d*A+g*w)*N,t[7]=(d*y-v*I-g*b)*N,t[8]=(v*A-p*y+g*M)*N,t):null},f.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},f.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},"undefined"!=typeof t&&(t.mat3=f);var m={};m.create=function(){var t=new e(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},m.clone=function(t){var r=new e(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},m.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},m.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},m.transpose=function(t,r){if(t===r){var e=r[1],n=r[2],a=r[3],i=r[6],o=r[7],u=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=e,t[6]=r[9],t[7]=r[13],t[8]=n,t[9]=i,t[11]=r[14],t[12]=a,t[13]=o,t[14]=u}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t},m.invert=function(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=r[4],u=r[5],s=r[6],c=r[7],l=r[8],f=r[9],m=r[10],h=r[11],v=r[12],p=r[13],d=r[14],g=r[15],M=e*u-n*o,b=e*s-a*o,y=e*c-i*o,w=n*s-a*u,A=n*c-i*u,I=a*c-i*s,P=l*p-f*v,C=l*d-m*v,x=l*g-h*v,F=f*d-m*p,V=f*g-h*p,T=m*g-h*d,N=M*T-b*V+y*F+w*x-A*C+I*P;return N?(N=1/N,t[0]=(u*T-s*V+c*F)*N,t[1]=(a*V-n*T-i*F)*N,t[2]=(p*I-d*A+g*w)*N,t[3]=(m*A-f*I-h*w)*N,t[4]=(s*x-o*T-c*C)*N,t[5]=(e*T-a*x+i*C)*N,t[6]=(d*y-v*I-g*b)*N,t[7]=(l*I-m*y+h*b)*N,t[8]=(o*V-u*x+c*P)*N,t[9]=(n*x-e*V-i*P)*N,t[10]=(v*A-p*y+g*M)*N,t[11]=(f*y-l*A-h*M)*N,t[12]=(u*C-o*F-s*P)*N,t[13]=(e*F-n*C+a*P)*N,t[14]=(p*b-v*w-d*M)*N,t[15]=(l*w-f*b+m*M)*N,t):null},m.adjoint=function(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=r[4],u=r[5],s=r[6],c=r[7],l=r[8],f=r[9],m=r[10],h=r[11],v=r[12],p=r[13],d=r[14],g=r[15];return t[0]=u*(m*g-h*d)-f*(s*g-c*d)+p*(s*h-c*m),t[1]=-(n*(m*g-h*d)-f*(a*g-i*d)+p*(a*h-i*m)),t[2]=n*(s*g-c*d)-u*(a*g-i*d)+p*(a*c-i*s),t[3]=-(n*(s*h-c*m)-u*(a*h-i*m)+f*(a*c-i*s)),t[4]=-(o*(m*g-h*d)-l*(s*g-c*d)+v*(s*h-c*m)),t[5]=e*(m*g-h*d)-l*(a*g-i*d)+v*(a*h-i*m),t[6]=-(e*(s*g-c*d)-o*(a*g-i*d)+v*(a*c-i*s)),t[7]=e*(s*h-c*m)-o*(a*h-i*m)+l*(a*c-i*s),t[8]=o*(f*g-h*p)-l*(u*g-c*p)+v*(u*h-c*f),t[9]=-(e*(f*g-h*p)-l*(n*g-i*p)+v*(n*h-i*f)),t[10]=e*(u*g-c*p)-o*(n*g-i*p)+v*(n*c-i*u),t[11]=-(e*(u*h-c*f)-o*(n*h-i*f)+l*(n*c-i*u)),t[12]=-(o*(f*d-m*p)-l*(u*d-s*p)+v*(u*m-s*f)),t[13]=e*(f*d-m*p)-l*(n*d-a*p)+v*(n*m-a*f),t[14]=-(e*(u*d-s*p)-o*(n*d-a*p)+v*(n*s-a*u)),t[15]=e*(u*m-s*f)-o*(n*m-a*f)+l*(n*s-a*u),t},m.determinant=function(t){var r=t[0],e=t[1],n=t[2],a=t[3],i=t[4],o=t[5],u=t[6],s=t[7],c=t[8],l=t[9],f=t[10],m=t[11],h=t[12],v=t[13],p=t[14],d=t[15],g=r*o-e*i,M=r*u-n*i,b=r*s-a*i,y=e*u-n*o,w=e*s-a*o,A=n*s-a*u,I=c*v-l*h,P=c*p-f*h,C=c*d-m*h,x=l*p-f*v,F=l*d-m*v,V=f*d-m*p;return g*V-M*F+b*x+y*C-w*P+A*I},m.multiply=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=r[6],l=r[7],f=r[8],m=r[9],h=r[10],v=r[11],p=r[12],d=r[13],g=r[14],M=r[15],b=e[0],y=e[1],w=e[2],A=e[3];return t[0]=b*n+y*u+w*f+A*p,t[1]=b*a+y*s+w*m+A*d,t[2]=b*i+y*c+w*h+A*g,t[3]=b*o+y*l+w*v+A*M,b=e[4],y=e[5],w=e[6],A=e[7],t[4]=b*n+y*u+w*f+A*p,t[5]=b*a+y*s+w*m+A*d,t[6]=b*i+y*c+w*h+A*g,t[7]=b*o+y*l+w*v+A*M,b=e[8],y=e[9],w=e[10],A=e[11],t[8]=b*n+y*u+w*f+A*p,t[9]=b*a+y*s+w*m+A*d,t[10]=b*i+y*c+w*h+A*g,t[11]=b*o+y*l+w*v+A*M,b=e[12],y=e[13],w=e[14],A=e[15],t[12]=b*n+y*u+w*f+A*p,t[13]=b*a+y*s+w*m+A*d,t[14]=b*i+y*c+w*h+A*g,t[15]=b*o+y*l+w*v+A*M,t},m.mul=m.multiply,m.translate=function(t,r,e){var n,a,i,o,u,s,c,l,f,m,h,v,p=e[0],d=e[1],g=e[2];return r===t?(t[12]=r[0]*p+r[4]*d+r[8]*g+r[12],t[13]=r[1]*p+r[5]*d+r[9]*g+r[13],t[14]=r[2]*p+r[6]*d+r[10]*g+r[14],t[15]=r[3]*p+r[7]*d+r[11]*g+r[15]):(n=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=r[6],l=r[7],f=r[8],m=r[9],h=r[10],v=r[11],t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=u,t[5]=s,t[6]=c,t[7]=l,t[8]=f,t[9]=m,t[10]=h,t[11]=v,t[12]=n*p+u*d+f*g+r[12],t[13]=a*p+s*d+m*g+r[13],t[14]=i*p+c*d+h*g+r[14],t[15]=o*p+l*d+v*g+r[15]),t},m.scale=function(t,r,e){var n=e[0],a=e[1],i=e[2];return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=r[7]*a,t[8]=r[8]*i,t[9]=r[9]*i,t[10]=r[10]*i,t[11]=r[11]*i,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},m.rotate=function(t,e,n,a){var i,o,u,s,c,l,f,m,h,v,p,d,g,M,b,y,w,A,I,P,C,x,F,V,T=a[0],N=a[1],E=a[2],R=Math.sqrt(T*T+N*N+E*E);return Math.abs(R)<r?null:(R=1/R,T*=R,N*=R,E*=R,i=Math.sin(n),o=Math.cos(n),u=1-o,s=e[0],c=e[1],l=e[2],f=e[3],m=e[4],h=e[5],v=e[6],p=e[7],d=e[8],g=e[9],M=e[10],b=e[11],y=T*T*u+o,w=N*T*u+E*i,A=E*T*u-N*i,I=T*N*u-E*i,P=N*N*u+o,C=E*N*u+T*i,x=T*E*u+N*i,F=N*E*u-T*i,V=E*E*u+o,t[0]=s*y+m*w+d*A,t[1]=c*y+h*w+g*A,t[2]=l*y+v*w+M*A,t[3]=f*y+p*w+b*A,t[4]=s*I+m*P+d*C,t[5]=c*I+h*P+g*C,t[6]=l*I+v*P+M*C,t[7]=f*I+p*P+b*C,t[8]=s*x+m*F+d*V,t[9]=c*x+h*F+g*V,t[10]=l*x+v*F+M*V,t[11]=f*x+p*F+b*V,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},m.rotateX=function(t,r,e){var n=Math.sin(e),a=Math.cos(e),i=r[4],o=r[5],u=r[6],s=r[7],c=r[8],l=r[9],f=r[10],m=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=i*a+c*n,t[5]=o*a+l*n,t[6]=u*a+f*n,t[7]=s*a+m*n,t[8]=c*a-i*n,t[9]=l*a-o*n,t[10]=f*a-u*n,t[11]=m*a-s*n,t},m.rotateY=function(t,r,e){var n=Math.sin(e),a=Math.cos(e),i=r[0],o=r[1],u=r[2],s=r[3],c=r[8],l=r[9],f=r[10],m=r[11];return r!==t&&(t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=i*a-c*n,t[1]=o*a-l*n,t[2]=u*a-f*n,t[3]=s*a-m*n,t[8]=i*n+c*a,t[9]=o*n+l*a,t[10]=u*n+f*a,t[11]=s*n+m*a,t},m.rotateZ=function(t,r,e){var n=Math.sin(e),a=Math.cos(e),i=r[0],o=r[1],u=r[2],s=r[3],c=r[4],l=r[5],f=r[6],m=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=i*a+c*n,t[1]=o*a+l*n,t[2]=u*a+f*n,t[3]=s*a+m*n,t[4]=c*a-i*n,t[5]=l*a-o*n,t[6]=f*a-u*n,t[7]=m*a-s*n,t},m.fromRotationTranslation=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=n+n,s=a+a,c=i+i,l=n*u,f=n*s,m=n*c,h=a*s,v=a*c,p=i*c,d=o*u,g=o*s,M=o*c;return t[0]=1-(h+p),t[1]=f+M,t[2]=m-g,t[3]=0,t[4]=f-M,t[5]=1-(l+p),t[6]=v+d,t[7]=0,t[8]=m+g,t[9]=v-d,t[10]=1-(l+h),t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},m.fromQuat=function(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=e+e,u=n+n,s=a+a,c=e*o,l=n*o,f=n*u,m=a*o,h=a*u,v=a*s,p=i*o,d=i*u,g=i*s;return t[0]=1-f-v,t[1]=l+g,t[2]=m-d,t[3]=0,t[4]=l-g,t[5]=1-c-v,t[6]=h+p,t[7]=0,t[8]=m+d,t[9]=h-p,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},m.frustum=function(t,r,e,n,a,i,o){var u=1/(e-r),s=1/(a-n),c=1/(i-o);return t[0]=2*i*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*s,t[6]=0,t[7]=0,t[8]=(e+r)*u,t[9]=(a+n)*s,t[10]=(o+i)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*c,t[15]=0,t},m.perspective=function(t,r,e,n,a){var i=1/Math.tan(r/2),o=1/(n-a);return t[0]=i/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+n)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*n*o,t[15]=0,t},m.ortho=function(t,r,e,n,a,i,o){var u=1/(r-e),s=1/(n-a),c=1/(i-o);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(r+e)*u,t[13]=(a+n)*s,t[14]=(o+i)*c,t[15]=1,t},m.lookAt=function(t,e,n,a){var i,o,u,s,c,l,f,h,v,p,d=e[0],g=e[1],M=e[2],b=a[0],y=a[1],w=a[2],A=n[0],I=n[1],P=n[2];return Math.abs(d-A)<r&&Math.abs(g-I)<r&&Math.abs(M-P)<r?m.identity(t):(f=d-A,h=g-I,v=M-P,p=1/Math.sqrt(f*f+h*h+v*v),f*=p,h*=p,v*=p,i=y*v-w*h,o=w*f-b*v,u=b*h-y*f,p=Math.sqrt(i*i+o*o+u*u),p?(p=1/p,i*=p,o*=p,u*=p):(i=0,o=0,u=0),s=h*u-v*o,c=v*i-f*u,l=f*o-h*i,p=Math.sqrt(s*s+c*c+l*l),p?(p=1/p,s*=p,c*=p,l*=p):(s=0,c=0,l=0),t[0]=i,t[1]=s,t[2]=f,t[3]=0,t[4]=o,t[5]=c,t[6]=h,t[7]=0,t[8]=u,t[9]=l,t[10]=v,t[11]=0,t[12]=-(i*d+o*g+u*M),t[13]=-(s*d+c*g+l*M),t[14]=-(f*d+h*g+v*M),t[15]=1,t)},m.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},m.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},"undefined"!=typeof t&&(t.mat4=m);var h={};h.create=function(){var t=new e(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},h.rotationTo=function(){var t=u.create(),r=u.fromValues(1,0,0),e=u.fromValues(0,1,0);return function(n,a,i){var o=u.dot(a,i);return-.999999>o?(u.cross(t,r,a),u.length(t)<1e-6&&u.cross(t,e,a),u.normalize(t,t),h.setAxisAngle(n,t,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(u.cross(t,a,i),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+o,h.normalize(n,n))}}(),h.setAxes=function(){var t=f.create();return function(r,e,n,a){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-e[0],t[5]=-e[1],t[8]=-e[2],h.normalize(r,h.fromMat3(r,t))}}(),h.clone=s.clone,h.fromValues=s.fromValues,h.copy=s.copy,h.set=s.set,h.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},h.setAxisAngle=function(t,r,e){e*=.5;var n=Math.sin(e);return t[0]=n*r[0],t[1]=n*r[1],t[2]=n*r[2],t[3]=Math.cos(e),t},h.add=s.add,h.multiply=function(t,r,e){var n=r[0],a=r[1],i=r[2],o=r[3],u=e[0],s=e[1],c=e[2],l=e[3];return t[0]=n*l+o*u+a*c-i*s,t[1]=a*l+o*s+i*u-n*c,t[2]=i*l+o*c+n*s-a*u,t[3]=o*l-n*u-a*s-i*c,t},h.mul=h.multiply,h.scale=s.scale,h.rotateX=function(t,r,e){e*=.5;var n=r[0],a=r[1],i=r[2],o=r[3],u=Math.sin(e),s=Math.cos(e);return t[0]=n*s+o*u,t[1]=a*s+i*u,t[2]=i*s-a*u,t[3]=o*s-n*u,t},h.rotateY=function(t,r,e){e*=.5;var n=r[0],a=r[1],i=r[2],o=r[3],u=Math.sin(e),s=Math.cos(e);return t[0]=n*s-i*u,t[1]=a*s+o*u,t[2]=i*s+n*u,t[3]=o*s-a*u,t},h.rotateZ=function(t,r,e){e*=.5;var n=r[0],a=r[1],i=r[2],o=r[3],u=Math.sin(e),s=Math.cos(e);return t[0]=n*s+a*u,t[1]=a*s-n*u,t[2]=i*s+o*u,t[3]=o*s-i*u,t},h.calculateW=function(t,r){var e=r[0],n=r[1],a=r[2];return t[0]=e,t[1]=n,t[2]=a,t[3]=-Math.sqrt(Math.abs(1-e*e-n*n-a*a)),t},h.dot=s.dot,h.lerp=s.lerp,h.slerp=function(t,r,e,n){var a,i,o,u,s,c=r[0],l=r[1],f=r[2],m=r[3],h=e[0],v=e[1],p=e[2],d=e[3];return i=c*h+l*v+f*p+m*d,0>i&&(i=-i,h=-h,v=-v,p=-p,d=-d),1-i>1e-6?(a=Math.acos(i),o=Math.sin(a),u=Math.sin((1-n)*a)/o,s=Math.sin(n*a)/o):(u=1-n,s=n),t[0]=u*c+s*h,t[1]=u*l+s*v,t[2]=u*f+s*p,t[3]=u*m+s*d,t},h.invert=function(t,r){var e=r[0],n=r[1],a=r[2],i=r[3],o=e*e+n*n+a*a+i*i,u=o?1/o:0;return t[0]=-e*u,t[1]=-n*u,t[2]=-a*u,t[3]=i*u,t},h.conjugate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=r[3],t},h.length=s.length,h.len=h.length,h.squaredLength=s.squaredLength,h.sqrLen=h.squaredLength,h.normalize=s.normalize,h.fromMat3=function(t,r){var e,n=r[0]+r[4]+r[8];if(n>0)e=Math.sqrt(n+1),t[3]=.5*e,e=.5/e,t[0]=(r[7]-r[5])*e,t[1]=(r[2]-r[6])*e,t[2]=(r[3]-r[1])*e;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;e=Math.sqrt(r[3*a+a]-r[3*i+i]-r[3*o+o]+1),t[a]=.5*e,e=.5/e,t[3]=(r[3*o+i]-r[3*i+o])*e,t[i]=(r[3*i+a]+r[3*a+i])*e,t[o]=(r[3*o+a]+r[3*a+o])*e}return t},h.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.quat=h)}(r.exports)}(this);var morphoviewer=function(t){function r(t,r){var n,a,i,o;if(n=document.getElementById(r),!n)return alert("mgl.getShaderFromDOM: no such shader: "+r),null;for(a="",i=n.firstChild;i;)i.nodeType==i.TEXT_NODE&&(a+=i.textContent),i=i.nextSibling;if("x-shader/x-fragment"==n.type)o=e(t,a,"fragment");else{if("x-shader/x-vertex"!=n.type)return alert("mgl.getShaderFromDOM: unknown shader type, returning null."),null;o=e(t,a,"vertex")}return o}function e(t,r,e){var n;if("fragment"==e)n=t.createShader(t.FRAGMENT_SHADER);else{if("vertex"!=e)return alert("mgl.getShaderFromString: unknown shader type, returning null."),null;n=t.createShader(t.VERTEX_SHADER)}return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(alert("mgl.getShaderFromString: could not compile "+e+" shader: "+t.getShaderInfoLog(n)),null)}function n(t,r,e){var n=t.createProgram();return t.attachShader(n,r),t.attachShader(n,e),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)||console.log("mgl.getProgram: unable to link the shader program "+t.getProgramInfoLog(n)),n}function a(t,r,e){return r>t?t=r:t>e&&(t=e),t}function i(t,r,e){return e>1&&(e=1),t+e*(r-t)}return t.Program=function(t){this.gl=t,this.object=null},t.Program.prototype.programFromDOM=function(t,e){var a=r(this.gl,e),i=r(this.gl,t);this.object=n(this.gl,i,a)},t.Program.prototype.programFromString=function(t,r){var a=e(this.gl,t,"vertex"),i=e(this.gl,r,"fragment");this.object=n(this.gl,a,i)},t.Program.prototype.use=function(){this.gl.useProgram(this.object)},t.Program.prototype.isInUse=function(){var t=0;return this.gl.getIntegerv(this.gl.GL_CURRENT_PROGRAM,t),this.object==t?!0:!1},t.Program.prototype.stopUsing=function(){this.isInUse()&&this.gl.useProgram(null)},t.Program.prototype.attribute=function(t){var r=this.gl.getAttribLocation(this.object,t);return-1==r?(console.log("ngl.Program.attribute: shader attribute "+t+" not found."),null):r},t.Program.prototype.uniform=function(t){var r=this.gl.getUniformLocation(this.object,t);return-1==r?(console.log("mgl.Program.uniform: shader uniform "+t+" not found."),null):r},t.Program.prototype.setUniform=function(t,r,e){switch(e.type){case"float":this.gl.uniform1f(this.uniform(t),r);
break;case"vec3":this.gl.uniform3fv(this.uniform(t),r);break;case"vec4":this.gl.uniform4fv(this.uniform(t),r);break;case"mat3":this.gl.uniformMatrix3fv(this.uniform(t),r);break;case"mat4":this.gl.uniformMatrix4fv(this.uniform(t),!1,r);break;case"int":this.gl.uniform1i(this.uniform(t),r);break;default:console.log("mgl.Program.setUniform: unknown type "+e.type)}},t.Mesh=function(t){this.gl=t,this.vbo=null,this.vno=null,this.numVertices=0},t.Mesh.prototype.object=function(){return this.vbo},t.Mesh.prototype.meshFromArray=function(t,r,e,n){this.vbo=this.gl.createBuffer(),this.numVertices=t.length/3;for(var a=new Array(t.length),i=0;i<3*this.numVertices;i+=9)a[i]=1,a[i+1]=0,a[i+2]=0,a[i+3]=0,a[i+4]=1,a[i+5]=0,a[i+6]=0,a[i+7]=0,a[i+8]=1;t=t.concat(a),t=t.concat(r),t=t.concat(e),t=t.concat(n),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)},t.Mesh.prototype.vertices=function(){return this.numVertices},t.Mesh.prototype.bind=function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo)},t.Mesh.prototype.unbind=function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)},t.Camera=function(t,r,e,n){this.position=vec3.fromValues(0,0,2),this.targetPosition=vec3.fromValues(0,0,2),this.targetRadius=2,this.radius=10,this.center=vec3.fromValues(0,0,0),this.targetCenter=vec3.fromValues(0,0,0),this.polar=Math.PI/2,this.azimuth=0,this.viewTransform=mat4.create(),this.orientation=quat.fromValues(0,0,0,0),this.sensitivity=.1*this.radius,this.verticalFOV=t,this.aspectRatio=r,this.nearPlane=e,this.farPlane=n,this.viewPerspective=!1,this.zoomFactor=1,this.targetZoomFactor=1},t.Camera.prototype.matrix=function(){var t=mat4.create();return mat4.multiply(t,this.perspective(),this.view()),t},t.Camera.prototype.viewAsOrtho=function(){this.viewPerspective=!1},t.Camera.prototype.viewAsPerspective=function(){this.viewPerspective=!0},t.Camera.prototype.perspective=function(){var t;return t=this.viewPerspective?mat4.perspective(mat4.create(),this.verticalFOV,this.aspectRatio,this.nearPlane,this.farPlane):mat4.ortho(mat4.create(),-i(this.nearPlane,this.farPlane,.01*this.aspectRatio*this.zoomFactor),i(this.nearPlane,this.farPlane,.01*this.aspectRatio*this.zoomFactor),-i(this.nearPlane,this.farPlane,.01*this.zoomFactor),i(this.nearPlane,this.farPlane,.01*this.zoomFactor),this.nearPlane,this.farPlane)},t.Camera.prototype.view=function(){return this.viewTransform},t.Camera.prototype.getPosition=function(){var t=vec3.fromValues(-this.position[0],-this.position[1],-this.position[2]);return t},t.Camera.prototype.setFOV=function(t){if(0>t)throw"mgl.Camera.setFOV: negative vertical field of view";this.verticalFOV=t},t.Camera.prototype.setAspectRatio=function(t){if(0>t)throw"mgl.Camera.setAspectRatio: negative aspect ratio";this.aspectRatio=t},t.Camera.prototype.setNearPlane=function(t){if(t>this.farPlane)throw"mgl.Camera.setNearPlane: near plane is farther than the far plane";this.nearPlane=t},t.Camera.prototype.setFarPlane=function(t){if(t<this.nearPlane)throw"mgl.Camera.setFarPlane: far plane is nearer than the near plane";this.farPlane=t},t.Camera.prototype.pan=function(t,r){deltaX=vec3.scale(vec3.create(),this.right(),this.sensitivity*t),vec3.add(this.targetCenter,this.targetCenter,deltaX),deltaY=vec3.scale(vec3.create(),this.up(),this.sensitivity*r),vec3.add(this.targetCenter,this.targetCenter,deltaY)},t.Camera.prototype.dolly=function(t){this.targetRadius+=this.sensitivity*t,this.targetRadius<0&&(this.targetRadius=.001)},t.Camera.prototype.orbit=function(t,r){this.polar-=r,this.polar=a(this.polar,.01,Math.PI),this.azimuth-=t},t.Camera.prototype.update=function(t){this.targetZoomFactor=.07*this.targetRadius,this.zoomFactor=i(this.zoomFactor,this.targetZoomFactor,20*t),this.radius=i(this.radius,this.targetRadius,20*t),vec3.lerp(this.center,this.center,this.targetCenter,20*t),this.sensitivity=.1*this.radius;var r=vec3.fromValues(Math.sin(this.polar)*Math.sin(this.azimuth),Math.cos(this.polar),Math.sin(this.polar)*Math.cos(this.azimuth));this.targetPosition=vec3.add(vec3.create(),this.center,vec3.scale(vec3.create(),r,this.radius)),vec3.lerp(this.position,this.position,this.targetPosition,20*t);var e=vec3.cross(vec3.create(),r,vec3.fromValues(0,1,0));vec3.normalize(e,e);var n=vec3.cross(vec3.create(),e,r);mat4.lookAt(this.viewTransform,this.position,this.center,n),quat.fromMat3(this.orientation,mat3.fromMat4(mat3.create(),this.viewTransform))},t.Camera.prototype.reset=function(){this.targetRadius=10,this.rotX=0,this.rotY=0},t.Camera.prototype.setBestPositionForModel=function(t){var r=Math.max(Math.abs(t.max.y),Math.abs(t.min.y)),e=Math.max(Math.abs(t.max.x),Math.abs(t.min.x)),n=Math.max(r,e);this.targetRadius=1.1*n/Math.tan(.5*this.verticalFOV)},t.Camera.prototype.forward=function(){var t=mat4.create();mat4.fromQuat(t,this.orientation),mat4.invert(t,t);var r=vec4.fromValues(0,0,-1,1);return vec4.transformMat4(r,r,t),vec3.fromValues(r[0],r[1],r[2])},t.Camera.prototype.right=function(){var t=mat4.fromQuat(mat4.create(),this.orientation);mat4.invert(t,t);var r=vec4.fromValues(1,0,0,1);return vec4.transformMat4(r,r,t),vec3.fromValues(r[0],r[1],r[2])},t.Camera.prototype.up=function(){var t=mat4.create();mat4.fromQuat(t,this.orientation),mat4.invert(t,t);var r=vec4.fromValues(0,1,0,1);return vec4.transformMat4(r,r,t),vec3.fromValues(r[0],r[1],r[2])},t.Camera.prototype.positionLeft=function(){this.targetCenter=vec3.fromValues(0,0,0),this.polar=Math.PI/2,this.azimuth=Math.PI/2},t.Camera.prototype.positionRight=function(){this.targetCenter=vec3.fromValues(0,0,0),this.polar=Math.PI/2,this.azimuth=3*Math.PI/2},t.Camera.prototype.positionTop=function(){this.targetCenter=vec3.fromValues(0,0,0),this.polar=.001,this.azimuth=0},t.Camera.prototype.positionBottom=function(){this.targetCenter=vec3.fromValues(0,0,0),this.polar=Math.PI,this.azimuth=0},t.Camera.prototype.positionFront=function(){this.targetCenter=vec3.fromValues(0,0,0),this.polar=Math.PI/2,this.azimuth=0},t.Camera.prototype.positionBack=function(){this.targetCenter=vec3.fromValues(0,0,0),this.polar=Math.PI/2,this.azimuth=Math.PI},t.directional={materialShininess:40,materialSurfaceColor:vec3.fromValues(.6,.6,.6),materialSpecularColor:vec3.fromValues(.9,.9,.9),lightDirection:vec3.fromValues(1,0,-1),lightHalfVector:vec3.fromValues(0,0,-1),lightIntensities:vec3.fromValues(1,1,.9),lightAmbientCoefficient:.1,camera:mat4.create(),model:mat4.create(),cameraPosition:vec3.fromValues(0,0,-1),enableAttributes:function(t,r){t.enableVertexAttribArray(r.attribute("vert")),t.enableVertexAttribArray(r.attribute("normal"))},setAttributes:function(t,r,e){t.vertexAttribPointer(r.attribute("vert"),3,t.FLOAT,!1,0,0),t.vertexAttribPointer(r.attribute("normal"),3,t.FLOAT,!1,0,24*e)},setUniforms:function(t){t.setUniform("material.shininess",this.materialShininess,{type:"float"}),t.setUniform("material.surfaceColor",this.materialSurfaceColor,{type:"vec3"}),t.setUniform("material.specularColor",this.materialSpecularColor,{type:"vec3"});var r=vec3.create();vec3.normalize(r,this.lightDirection),t.setUniform("light.direction",r,{type:"vec3"});var e=vec3.create();vec3.normalize(e,this.lightHalfVector),t.setUniform("light.halfVector",e,{type:"vec3"}),t.setUniform("light.intensities",this.lightIntensities,{type:"vec3"}),t.setUniform("light.ambientCoefficient",this.lightAmbientCoefficient,{type:"float"});var n=mat4.create();mat4.invert(n,this.model),mat4.transpose(n,n),t.setUniform("camera",this.camera,{type:"mat4"}),t.setUniform("normalMatrix",n,{type:"mat4"}),t.setUniform("model",this.model,{type:"mat4"}),t.setUniform("cameraPosition",this.cameraPosition,{type:"vec3"})},vertex:"uniform mat4 model;\nuniform mat4 normalMatrix;\nuniform mat4 camera;\nuniform mediump vec3 cameraPosition;\nattribute vec3 vert;\nattribute vec3 normal;\nvarying mediump vec3 surfToCamera;\nvarying mediump vec3 fragPos;\nvarying mediump vec3 fragNormal;\nvoid main( void ) {\n	//just pass this value through for interpolation\n	fragNormal = vec3( normalMatrix * vec4( normal, 0.0 ) );\n	fragPos = vec3( model * vec4( vert, 1.0 ) );\n	surfToCamera = normalize( vec3( cameraPosition - fragPos ) );\n	gl_Position = camera * model * vec4( vert, 1.0 );\n}",fragment:"struct Material {\n	mediump float shininess;\n	mediump vec3 surfaceColor;\n	mediump vec3 specularColor;\n};\nstruct DirectionalLight {\n	mediump vec3 direction;	//this needs to be normalized\n	mediump vec3 halfVector;\n	mediump vec3 intensities;\n	mediump float ambientCoefficient;\n};\nuniform Material material;\nuniform DirectionalLight light;\nvarying mediump vec3 surfToCamera;\nvarying mediump vec3 fragPos;\nvarying mediump vec3 fragNormal;\nvoid main( void ) {\n	//ambient\n	mediump vec3 ambient = light.ambientCoefficient * material.surfaceColor * light.intensities;\n	//diffuse\n	mediump float diffuseCoefficient =  max( 0.0, dot( fragNormal, light.direction ) );\n	mediump vec3 diffuse = diffuseCoefficient * material.surfaceColor * light.intensities;\n	//specular\n	mediump float specularCoefficient = 0.0;\n	if ( diffuseCoefficient > 0.0 ) {\n		mediump vec3 reflection = normalize( reflect( light.halfVector, fragNormal ) );\n		specularCoefficient = pow( max( 0.0, dot( surfToCamera, reflection ) ), material.shininess );\n	}\n	mediump vec3 specular = specularCoefficient * material.specularColor;\n	mediump vec3 linearColor = ambient + diffuse + specular;\n	mediump vec3 gamma = vec3( 1.0 / 2.2 );\n	gl_FragColor = vec4( pow( linearColor, gamma ), 1.0 );\n}"},t.color={camera:mat4.create(),model:mat4.create(),colorMode:1,enableAttributes:function(t,r){t.enableVertexAttribArray(r.attribute("vert")),t.enableVertexAttribArray(r.attribute("curvature")),t.enableVertexAttribArray(r.attribute("orientation"))},setAttributes:function(t,r,e){t.vertexAttribPointer(r.attribute("vert"),3,t.FLOAT,!1,0,0),t.vertexAttribPointer(r.attribute("curvature"),1,t.FLOAT,!1,0,36*e),t.vertexAttribPointer(r.attribute("orientation"),1,t.FLOAT,!1,0,40*e)},setUniforms:function(t){t.setUniform("camera",this.camera,{type:"mat4"}),t.setUniform("model",this.model,{type:"mat4"}),t.setUniform("colorMode",this.colorMode,{type:"int"})},vertex:"precision mediump float;\nattribute vec3 vert;\nattribute float curvature;\nattribute float orientation;\nuniform mat4 model;\nuniform mat4 camera;\nuniform int colorMode;\nvarying vec4 fragColor;\nvec4 rainbowColor( float scalar );\nvoid main() {\n	if ( colorMode == 1 ) {	//dirichlet normal energy\n		fragColor = rainbowColor( curvature );\n	} else if ( colorMode == 2 ) {	//orientation map\n		fragColor = rainbowColor( orientation );\n	}\n	gl_Position = camera * model * vec4( vert, 1.0 );\n}\nvec4 rainbowColor( float scalar ) {	//scalar must be normalized!\n	vec3 color = vec3( 0.0, 0.0, 0.0 );\n	//if ( scalar >= 0.0 && scalar < 0.2 ) {\n	//	color.r = 5.0 * scalar;\n	//	color.b = 1.0;\n	if ( scalar >= 0.0 && scalar < 0.25 ) {\n		color.g = scalar * 4.0;	//green varies linearly between [0,1]\n		color.b = 1.0;			//blue is maxed out\n	} else if ( scalar >= 0.25 && scalar < 0.35 ) {\n		color.g = 1.0;			//green is maxed out\n		color.b = 1.0 - 10.0 * ( scalar - 0.25 );	//blue varies between [1,0]\n	} else if ( scalar >= 0.35 && scalar < 0.75 ) {\n		color.r = ( scalar - 0.35 ) * 2.5;	//red varies between [0,1]\n		color.g = 1.0;					//green is maxed out\n	} else if ( scalar >= 0.75 && scalar <= 1.0 ) {\n		color.r = 1.0;	//red is maxed out\n		color.g = 1.0 - 4.0 * ( scalar - 0.75 );	//green varies between [1,0]\n	}\n	return vec4( color, 1.0 );\n}\n",fragment:"precision mediump float;\nvarying vec4 fragColor;\nvoid main() {\n	gl_FragColor = fragColor;\n}\n"},t.wireframe={camera:mat4.create(),model:mat4.create(),surfaceColor:vec3.fromValues(.6,.6,.6),enableAttributes:function(t,r){t.enableVertexAttribArray(r.attribute("vert")),t.enableVertexAttribArray(r.attribute("barycentric"))},setAttributes:function(t,r,e){t.vertexAttribPointer(r.attribute("vert"),3,t.FLOAT,!1,0,0),t.vertexAttribPointer(r.attribute("barycentric"),3,t.FLOAT,!1,0,12*e)},setUniforms:function(t){t.setUniform("camera",this.camera,{type:"mat4"}),t.setUniform("model",this.model,{type:"mat4"}),t.setUniform("surfaceColor",this.surfaceColor,{type:"vec3"})},vertex:"attribute vec3 vert;\nattribute vec3 barycentric;\nuniform mat4 camera;\nuniform mat4 model;\nvarying mediump vec3 barycentricPos;\nvoid main( void ) {\n	barycentricPos = barycentric;\n	gl_Position = camera * model * vec4( vert, 1.0 );\n}",fragment:"uniform mediump vec3 surfaceColor;\nvarying mediump vec3 barycentricPos;\nvoid main( void ) {\n	if ( any( lessThan( barycentricPos, vec3( 0.02 ) ) ) ) {\n		gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n	} else {\n		gl_FragColor = vec4( surfaceColor, 1.0 );\n	}\n}"},t.hemisphere={camera:mat4.create(),model:mat4.create(),normalMatrix:mat4.create(),skyColor:vec3.fromValues(.83,.819,.819),groundColor:vec3.fromValues(.181,.161,.095),polar:0,azimuth:0,enableAttributes:function(t,r){t.enableVertexAttribArray(r.attribute("vert")),t.enableVertexAttribArray(r.attribute("norm"))},setAttributes:function(t,r,e){t.vertexAttribPointer(r.attribute("vert"),3,t.FLOAT,!1,0,0),t.vertexAttribPointer(r.attribute("norm"),3,t.FLOAT,!1,0,24*e)},setUniforms:function(t){var r=vec3.fromValues(Math.sin(this.polar)*Math.sin(this.azimuth),Math.cos(this.polar),Math.sin(this.polar)*Math.cos(this.azimuth));t.setUniform("lightPosition",r,{type:"vec3"}),t.setUniform("skyColor",this.skyColor,{type:"vec3"}),t.setUniform("groundColor",this.groundColor,{type:"vec3"});var e=mat4.create();mat4.invert(e,this.model),mat4.transpose(e,e),t.setUniform("normalMatrix",e,{type:"mat4"}),t.setUniform("camera",this.camera,{type:"mat4"}),t.setUniform("model",this.model,{type:"mat4"})},vertex:"precision mediump float;\nattribute vec3 vert;\nattribute vec3 norm;\nuniform mat4 camera;\nuniform mat4 model;\nuniform mat4 normalMatrix;\nuniform vec3 lightPosition;\nuniform vec3 skyColor;\nuniform vec3 groundColor;\nvarying vec3 fragColor;\nvoid main() {\n	vec3 fragNormal = vec3( normalMatrix * vec4( norm, 0.0 ) );\n	vec3 position = vec3( model * vec4( vert, 1.0 ) );\n	vec3 lightVector = normalize( lightPosition - normalize( position ) );\n	float theta = dot( fragNormal, lightVector );\n	float a = theta * 0.5 + 0.5;\n	fragColor = mix( groundColor, skyColor, a );\n	gl_Position = camera * model * vec4( vert, 1.0 );\n}",fragment:"precision mediump float;\nvarying vec3 fragColor;\nvoid main() {\n	gl_FragColor = vec4(fragColor, 1.0 );\n}"},t}(morphoviewer||{}),morphoviewer=function(t){function r(t,r){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(t){r(t.target.response)},e.send()}function e(t,r){for(var e=[],n=new Uint8Array(t),a=0;a<n.length;){var o=i(n,a);a+=o.length+1;var u=o.split(r);e.push([parseFloat(u[0]),parseFloat(u[1]),parseFloat(u[2])])}return e}function n(t){for(var r={vertices:{v:[],i:[]},normals:{v:[],i:[]}},e=0,n=new Uint8Array(t);e<n.length;){var a=i(n,e);e+=a.length+1,a=a.replace(/ +(?= )/g,""),a=a.replace(/(^\s+|\s+$)/g,"");var o=a.split(" ");if("v"==o[0]&&r.vertices.v.push([parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3])]),"vn"==o[0]&&r.normals.v.push([parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3])]),"f"==o[0]){var u=r.vertices.v.length,s=r.normals.v.length,c=o[1].split("/");if(1==c.length){var c=parseInt(c)-1;0>c&&(c=u+c+1);for(var l=2;l<o.length-1;l++){var f=parseInt(o[l])-1,m=parseInt(o[l+1])-1;0>f&&(f=u+f+1,m=u+m+1),r.vertices.i.push([c,f,m]),r.normals.v.length>0&&r.normals.i.push([c,f,m])}}else{var h=parseInt(c[0])-1,v=parseInt(c[2])-1;0>h&&(h=u+h+1),0>v&&(v=s+v+1);for(var l=2;l<o.length-1;l++){var f=o[l].split("/"),m=o[l+1].split("/"),p=parseInt(f[0])-1,d=parseInt(m[0])-1,g=parseInt(f[2])-1,M=parseInt(m[2])-1;0>p&&(p=u+p+1,d=u+d+1),0>g&&(g=s+g+1,M=s+M+1),r.vertices.push([h,p,d]),r.normals.push([v,g,M])}}}}return r}function i(t,r){for(var e="";10!=t[r];)e+=String.fromCharCode(t[r++]);return e}function o(t){for(var r=0,e=0,n=0,a=0;a<t.length;a++)r+=t[a][0],e+=t[a][1],n+=t[a][2];return r/=t.length,e/=t.length,n/=t.length,[r,e,n]}function u(t){for(var r=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,u=0;u<t.length;u++)t[u][0]<r&&(r=t[u][0]),t[u][0]>e&&(e=t[u][0]),t[u][1]<n&&(n=t[u][1]),t[u][1]>a&&(a=t[u][1]),t[u][2]<i&&(i=t[u][2]),t[u][2]>o&&(o=t[u][2]);var s=e-r,c=a-n,l=o-i,f=r+.5*s,m=n+.5*c,h=i+.5*l,v=Math.max(s,c,l);return[[f-10*v,m-v,h-10*v],[f,m+10*v,h],[f+10*v,m-v,h+10*v]]}function s(t,r,e,n){var a=[t[r][0]-t[e][0],t[r][1]-t[e][1],t[r][2]-t[e][2]],i=[t[n][0]-t[r][0],t[n][1]-t[r][1],t[n][2]-t[r][2]],o=[a[1]*i[2]-a[2]*i[1],a[2]*i[0]-a[0]*i[2],a[0]*i[1]-a[1]*i[0]];vec3.cross(o,a,i);var u=[t[e][0]+.5*a[0],t[e][1]+.5*a[1],t[e][2]+.5*a[2]],s=[t[r][0]+.5*i[0],t[r][1]+.5*i[1],t[r][2]+.5*i[2]],c=[o[1]*a[2]-o[2]*a[1],o[2]*a[0]-o[0]*a[2],o[0]*a[1]-o[1]*a[0]],l=[o[1]*i[2]-o[2]*i[1],o[2]*i[0]-o[0]*i[2],o[0]*i[1]-o[1]*i[0]],f=mat2.create();f[0]=c[0],f[1]=-l[0],f[2]=c[1],f[3]=-l[1];var m=vec2.fromValues(s[0]-u[0],s[1]-u[1]);mat2.invert(f,f);var h=f[0]*m[0]+f[1]*m[1],v=[u[0]+h*c[0],u[1]+h*c[1],u[2]+h*c[2]],p=(t[r][0]-v[0])*(t[r][0]-v[0])+(t[r][1]-v[1])*(t[r][1]-v[1])+(t[r][2]-v[2])*(t[r][2]-v[2]);return{center:v,radiusSquared:p}}function c(t,r){var e=[r[0]-t.center[0],r[1]-t.center[1],r[2]-t.center[2]],n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];return t.radiusSquared-n>v?!0:!1}function l(t){for(var r=t.length-2;r>-1;r--)for(var e=r+1;e<t.length;e++)a=t[r][0],b=t[r][1],x=t[e][0],y=t[e][1],(a===x&&b===y||a===y&&b===x)&&(t.splice(e,1),t.splice(r,1))}function f(t,r){for(var e=new Array(t.length),n=0;n<r.length;n++){var a=vec3.fromValues(t[r[n][1]][0]-t[r[n][0]][0],t[r[n][1]][1]-t[r[n][0]][1],t[r[n][1]][2]-t[r[n][0]][2]),i=vec3.fromValues(t[r[n][2]][0]-t[r[n][0]][0],t[r[n][2]][1]-t[r[n][0]][1],t[r[n][2]][2]-t[r[n][0]][2]),o=vec3.cross(vec3.create(),a,i);e[r[n][0]]=[o[0],o[1],o[2]],e[r[n][1]]=[o[0],o[1],o[2]],e[r[n][2]]=[o[0],o[1],o[2]]}return e}function m(t){return t>1e3&&(t=1e3),t}function h(t){return t>2*Math.PI?t-2*Math.PI:0>t?t+2*Math.PI:t}var v=1/1048576;return t.vertexArrayFromOBJ=function(t,e){var a=function(t){var r=n(t);void 0!=e&&e(r)};r(t,a)},t.vertexArrayFromPointCloud=function(t,n,a){"undefined"==typeof a&&(a=",");var i=function(t){var r=e(t,a);void 0!=n&&n(r)};r(t,i)},t.centerPointCloud=function(t){for(var r=o(t),e=0;e<t.length;e++)t[e][0]-=r[0],t[e][1]-=r[1],t[e][2]-=r[2]},t.unwrapArray=function(t,r){for(var e=[],n=0;n<r.length;n++){if(r[n][0]>=t.length||r[n][1]>=t.length||r[n][2]>=t.length)throw console.log(r[n][0]+" "+r[n][1]+" "+r[n][2]+", length: "+t.length),"MESH FAILURE";e.push(t[r[n][0]][0],t[r[n][0]][1],t[r[n][0]][2]),e.push(t[r[n][1]][0],t[r[n][1]][1],t[r[n][1]][2]),e.push(t[r[n][2]][0],t[r[n][2]][1],t[r[n][2]][2])}return e},t.getAabb=function(t){for(var r=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,u=0;u<t.length;u++)t[u][0]<r&&(r=t[u][0]),t[u][0]>e&&(e=t[u][0]),t[u][1]<n&&(n=t[u][1]),t[u][1]>a&&(a=t[u][1]),t[u][2]<i&&(i=t[u][2]),t[u][2]>o&&(o=t[u][2]);return{min:{x:r,y:n,z:i},max:{x:e,y:a,z:o},center:{x:r+e/2,y:n+a/2,z:i+o/2}}},t.triangulate=function(t){for(var r=Delaunay.triangulate(t),e=[],n=0;n<r.length;n+=3)e.push([r[n],r[n+1],r[n+2]]);return e},t.delaunay=function(t){var r=t.length;if(3>r)return[];var e=[],n=[];t.sort(function(t,r){return t[0]-r[0]});var a=u(t);t.push(a[0],a[1],a[2]),e.push([r,r+1,r+2]);for(var i=r-1;i>-1;i--){for(var o=[],f=t[i],m=e.length-1;m>-1;m-=1){var h=s(t,e[m][0],e[m][1],e[m][2]);if(c(h,f))o.push([e[m][0],e[m][1]],[e[m][1],e[m][2]],[e[m][2],e[m][0]]),e.splice(m,1);else{var v=h.center[0]-f[0];v>0&&(n.push(e[m].slice(0)),e.splice(m,1))}}l(o);for(var m=0;m<o.length;m++)e.push([o[m][0],o[m][1],i])}for(var i=0;i<e.length;i++)n.push(e[i].slice(0));e=[];for(var i=n.length-1;i>-1;i-=1)n[i][0]<r&&n[i][1]<r&&n[i][2]<r&&e.push(n[i].slice(0));return t.splice(r,3),e},t.faceNormals=function(t,r){for(var e=new Array(t.length),n=0;n<r.length;n++){var a=vec3.fromValues(t[r[n][1]][0]-t[r[n][0]][0],t[r[n][1]][1]-t[r[n][0]][1],t[r[n][1]][2]-t[r[n][0]][2]),i=vec3.fromValues(t[r[n][2]][0]-t[r[n][0]][0],t[r[n][2]][1]-t[r[n][0]][1],t[r[n][2]][2]-t[r[n][0]][2]),o=vec3.cross(vec3.create(),a,i);vec3.normalize(o,o),e[r[n][0]]=[o[0],o[1],o[2]],e[r[n][1]]=[o[0],o[1],o[2]],e[r[n][2]]=[o[0],o[1],o[2]]}return e},t.vertexNormals=function(t,r){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=[];for(var n=0;n<r.length;n++)e[r[n][0]].push(r[n][1],r[n][2]),e[r[n][1]].push(r[n][0],r[n][2]),e[r[n][2]].push(r[n][0],r[n][1]);for(var a=f(t,r),i=new Array(t.length),n=0;n<t.length;n++){for(var o=vec3.fromValues(0,0,0),u=0;u<e[n].length;u++)vec3.add(o,o,vec3.fromValues(a[e[n][u]][0],a[e[n][u]][1],a[e[n][u]][2]));vec3.normalize(o,o),i[n]=new Array(3),i[n][0]=o[0],i[n][1]=o[1],i[n][2]=o[2]}return i},t.surfaceVariation=function(t,r){for(var e=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY,a=[],i=0;i<t.length;i+=9){var o=vec3.fromValues(t[i+3]-t[i],t[i+4]-t[i+1],t[i+5]-t[i+2]),u=vec3.fromValues(t[i+6]-t[i],t[i+7]-t[i+1],t[i+8]-t[i+2]),s=mat2.create();s[0]=vec3.dot(o,o),s[1]=vec3.dot(o,u),s[2]=vec3.dot(o,u),s[3]=vec3.dot(u,u);var c=vec3.fromValues(r[i+3]-r[i],r[i+4]-r[i+1],r[i+5]-r[i+2]),l=vec3.fromValues(r[i+6]-r[i],r[i+7]-r[i+1],r[i+8]-r[i+2]),f=mat2.create();f[0]=vec3.dot(c,c),f[1]=vec3.dot(c,l),f[2]=vec3.dot(c,l),f[3]=vec3.dot(l,l);var h=mat2.create();mat2.invert(s,s),mat2.multiply(h,s,f);var v=h[0]+h[3];v=m(v),a.push(v),a.push(v),a.push(v),v>e?e=v:n>v&&(n=v)}for(var i=0;i<a.length;i++)a[i]/=e,a[i]=1-Math.exp(2.99572315-15*a[i])/20;return a},t.surfaceOrientation=function(t){for(var r=[],e=8,n=0;n<t.length;n+=3){var a=vec2.normalize(vec2.create(),vec2.fromValues(t[n],t[n+1])),i=h(Math.atan2(a[1],a[0])),o=Math.floor(i/(2*Math.PI/e));o/=e-1,r.push(o)}return r},t}(morphoviewer||{}),morphoviewer=function(t){function r(t){var r=null;try{r=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(e){}return r}function e(){m=new t.Program(c),m.programFromString(t.wireframe.vertex,t.wireframe.fragment),v=new t.Program(c),v.programFromString(t.color.vertex,t.color.fragment),h=new t.Program(c),h.programFromString(t.directional.vertex,t.directional.fragment),hemisphereProgram=new t.Program(c),hemisphereProgram.programFromString(t.hemisphere.vertex,t.hemisphere.fragment)}function n(t){var r=window.event||t,e=r.detail?-120*r.detail:r.wheelDelta;l.dolly(e*-.0025)}function a(t){switch(!t.which&&t.button&&(1&t.button?t.which=1:4&t.button?t.which=2:2&t.button&&(t.which=3)),w.prevX=t.pageX,w.prevY=t.pageY,t.which){case 1:canvas.onmousemove=function(t){o(t),l.orbit(.004*w.dx,.004*w.dy)};break;case 3:canvas.onmousemove=function(t){o(t),l.pan(w.dx*-.01,.01*w.dy)}}}function i(){canvas.onmousemove=function(){return!1}}function o(t){var r=t.pageX,e=t.pageY;w.dx=r-w.prevX,w.dy=e-w.prevY,w.prevX=r,w.prevY=e}function u(){c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT);var t=new Date,r=t-d;r/=1e3,l.update(r),y(),d=new Date}function s(){f.bind(),t.color.enableAttributes(c,p),t.color.setAttributes(c,p,f.vertices()),f.unbind(),y=function(){f.bind(),t.color.camera=l.matrix(),t.color.model=b,t.color.setUniforms(p),c.drawArrays(c.TRIANGLES,0,f.vertices()),f.unbind()}}{var c,l,f,m,h,v,p,d,g={},M=40,b=mat4.create(),y=function(){},w={prevX:0,prevY:0,dx:0,dy:0};Math.PI/2}return g.initialize=function(o){cid=void 0==o?"glcanvas":o,canvas=document.getElementById(cid),canvas.onmousedown=a,canvas.onmouseup=i,canvas.oncontextmenu=function(t){t.preventDefault()};var s=/FireFox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";document.attachEvent?document.attachEvent("on"+s,n):document.addEventListener&&document.addEventListener(s,n,!1),c=r(canvas),c?(c.clearColor(.1,.16,.16,1),c.enable(c.DEPTH_TEST),c.depthFunc(c.LEQUAL),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT),setInterval(u,1e3/M)):alert("morphoviewer.initialize: Unable to initialize WebGL. Your browser may not support it."),d=new Date;var f=canvas.clientWidth/canvas.clientHeight;l=new t.Camera(67*Math.PI/180,f,.01,1e3),e()},g.viewData=function(r,e){if("obj"==e){f=new t.Mesh(c);var n=function(r){t.centerPointCloud(r.vertices.v);var e,n=t.unwrapArray(r.vertices.v,r.vertices.i);0==r.normals.v.length?(e=t.vertexNormals(r.vertices.v,r.vertices.i),e=t.unwrapArray(e,r.vertices.i)):e=t.unwrapArray(r.normals.v,r.normals.i);var a=t.surfaceVariation(n,e),i=t.surfaceOrientation(e);f.meshFromArray(n,e,a,i),g.viewIlluminated();var o=t.getAabb(r.vertices.v);l.setBestPositionForModel(o)};t.vertexArrayFromOBJ(r,n)}else{if("point cloud"!=e)throw"morphoviewer.view: unrecognized 3d file type";f=new t.Mesh(c);var n=function(r){t.centerPointCloud(r);var e=t.triangulate(r),n=t.unwrapArray(r,e),a=t.vertexNormals(r,e);a=t.unwrapArray(a,e);var i=t.surfaceVariation(n,a),o=t.surfaceOrientation(a);f.meshFromArray(n,a,i,o),g.viewIlluminated();var u=t.getAabb(r);l.setBestPositionForModel(u)};t.vertexArrayFromPointCloud(r,n)}},g.viewWireframe=function(){p=m,p.use(),f.bind(),t.wireframe.enableAttributes(c,p),t.wireframe.setAttributes(c,p,f.vertices()),f.unbind(),y=function(){f.bind(),t.wireframe.camera=l.matrix(),t.wireframe.model=b,t.wireframe.setUniforms(p),c.drawArrays(c.TRIANGLES,0,f.vertices()),f.unbind()}},g.viewSurfaceOrientation=function(){p.object!=v.object&&(p=v,p.use(),s()),t.color.colorMode=2},g.viewSurfaceCurvature=function(){p.object!=v.object&&(p=v,p.use(),s()),t.color.colorMode=1},g.viewIlluminated=function(){p=h,p.use(),f.bind(),t.directional.enableAttributes(c,p),t.directional.setAttributes(c,p,f.vertices()),f.unbind(),y=function(){f.bind(),t.directional.camera=l.matrix(),t.directional.model=b,t.directional.cameraPosition=l.getPosition(),t.directional.setUniforms(p),c.drawArrays(c.TRIANGLES,0,f.vertices()),f.unbind()}},g.viewHemispherical=function(){p=hemisphereProgram,p.use(),f.bind(),t.hemisphere.enableAttributes(c,p),t.hemisphere.setAttributes(c,p,f.vertices()),f.unbind(),y=function(){f.bind(),t.hemisphere.camera=l.matrix(),t.hemisphere.model=b,t.hemisphere.setUniforms(p),c.drawArrays(c.TRIANGLES,0,f.vertices()),f.unbind()}},g.viewOrtho=function(){l.viewAsOrtho()},g.viewPerspective=function(){l.viewAsPerspective()},g.viewLeft=function(){l.positionLeft()},g.viewRight=function(){l.positionRight()},g.viewTop=function(){l.positionTop()},g.viewBottom=function(){l.positionBottom()},g.viewFront=function(){l.positionFront()},g.viewBack=function(){l.positionBack()},g.color={black:vec3.fromValues(0,0,0),white:vec3.fromValues(1,1,1),lightgray:vec3.fromValues(.91,.91,.91),lightgrey:vec3.fromValues(.91,.91,.91),darkgray:vec3.fromValues(.41,.41,.41),darkgrey:vec3.fromValues(.41,.41,.41)},g.setBackgroundColor=function(t){c.clearColor(t[0],t[1],t[2],1)},g.setLightPolarAngle=function(r){t.hemisphere.polar=r},g.setLightAzimuthalAngle=function(r){t.hemisphere.azimuth=r},g}(morphoviewer);